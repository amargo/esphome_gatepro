esphome:
  name: "drivewaygate"
  friendly_name: DrivewayGateOG

esp32:
  board: esp32dev
  framework:
    type: arduino

# Enable logging
logger:

# Enable Home Assistant API
api:
  encryption:
    key: "1qQPk6j5F7fQjur9jVdOLrkSYA+mASsfAnZMhUKv9Hk="

ota:
  - platform: esphome
    password: "6055d42f1bf803b9b2486ac747021376"

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

  # Enable fallback hotspot (captive portal) in case wifi connection fails
  ap:
    ssid: "Drivewaygateog Fallback Hotspot"
    password: "Fh6apQlf8x8V"

captive_portal:

web_server:
  version: 3

uart:
  baud_rate: 9600
  tx_pin: GPIO17
  rx_pin: GPIO16

sensor:
  - platform: wifi_signal
    name: "WiFi Signal dB"
    id: wifi_signal_db
    update_interval: 60s
    entity_category: "diagnostic"

switch:
  - platform: uart
    name: "Gate toggle switch"
    id: "gate_toggle_switch"
    data:
      turn_on: "FULL OPEN;src=P00287D7\r\n"
      turn_off: "FULL CLOSE;src=P00287D7\r\n"

external_components:
  - source:
      type: git
      url: https://github.com/markv9401/esphome-external-component-uart-reader
      ref: main
    components: [ gatepro ]
    refresh: 0s

gatepro:
  update_interval: 0.5s
  open:
    name: "Gate open sensor"
    id: gate_open_sensor
  status:
    name: "Gate status sensor"
    id: gate_status_sensor
